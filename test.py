# -*- coding: utf-8 -*-
"""
Created on Fri May 10 15:55:30 2019

@author: adoxey3
"""

# -*- coding: utf-8 -*-
"""
Created on Fri May  3 10:40:55 2019

@author: ngrasley
"""

import sys
sys.path.append("R:/JoePriceResearch/record_linking/projects/deep_learning/ml-record-linking/Splycer")
from Splycer.Splycer         import Splycer
from FeatureEngineer import FeatureEngineer
from XGBoostMatch    import XGBoostMatch

import pickle as pkl
import pandas as pd
import pyodbc
import traceback
from time import time






def main():
    index1 = 100000
    index2 = 200000

    sql_code = f"""
SELECT census_1900.index_1900, census_1900.marstat_1900, census_1900.birth_year_1900, census_1900.household_1900, census_1900.immigration_1900, census_1900.race_1900, census_1900.rel_1900,
	   census_1900.female_1900, census_1900.bp_1900, census_1900.mbp_1900, census_1900.fbp_1900, census_1900.state_1900, census_1900.county_1900, census_1900.cohort1_1900,
	   census_1900.cohort2_1900, census_1900.last_sdxn_1900, census_1900.first_sdxn_1900, census_1900.last_init_1900, census_1900.first_init_1900,
	   bplace_comm_1910.bp_comm_1910, first_comm_1900.first_comm_1900, last_comm_1900.last_comm_1900,
	   stringnames_1900.first_1900, stringnames_1900.last_1900,
	   geo_bplace_1900.bp_lat as bp_lat_1900, geo_bplace_1900.bp_lon as bp_lon_1900,
	   geo_res_1900.res_lat as res_lat_1900, geo_res_1900.res_lon as res_lon_1900,
	   nickname_1900.full_name as full_name_1900,
	   first_vec_1900.first_vec2 as first_vec2_1900, first_vec_1900.first_vec3 as first_vec3_1900, first_vec_1900.first_vec4 as first_vec4_1900, first_vec_1900.first_vec5 as first_vec5_1900, first_vec_1900.first_vec6 as first_vec6_1900, first_vec_1900.first_vec7 as first_vec7_1900, first_vec_1900.first_vec8 as first_vec8_1900, first_vec_1900.first_vec9 as first_vec9_1900, first_vec_1900.first_vec10 as first_vec10_1900, first_vec_1900.first_vec11 as first_vec11_1900, first_vec_1900.first_vec12 as first_vec12_1900, first_vec_1900.first_vec13 as first_vec13_1900, first_vec_1900.first_vec14 as first_vec14_1900, first_vec_1900.first_vec15 as first_vec15_1900, first_vec_1900.first_vec16 as first_vec16_1900, first_vec_1900.first_vec17 as first_vec17_1900, first_vec_1900.first_vec18 as first_vec18_1900, first_vec_1900.first_vec19 as first_vec19_1900, first_vec_1900.first_vec20 as first_vec20_1900, first_vec_1900.first_vec21 as first_vec21_1900, first_vec_1900.first_vec22 as first_vec22_1900, first_vec_1900.first_vec23 as first_vec23_1900, first_vec_1900.first_vec24 as first_vec24_1900, first_vec_1900.first_vec25 as first_vec25_1900, first_vec_1900.first_vec26 as first_vec26_1900, first_vec_1900.first_vec27 as first_vec27_1900, first_vec_1900.first_vec28 as first_vec28_1900, first_vec_1900.first_vec29 as first_vec29_1900, first_vec_1900.first_vec30 as first_vec30_1900, first_vec_1900.first_vec31 as first_vec31_1900, first_vec_1900.first_vec32 as first_vec32_1900, first_vec_1900.first_vec33 as first_vec33_1900, first_vec_1900.first_vec34 as first_vec34_1900, first_vec_1900.first_vec35 as first_vec35_1900, first_vec_1900.first_vec36 as first_vec36_1900, first_vec_1900.first_vec37 as first_vec37_1900, first_vec_1900.first_vec38 as first_vec38_1900, first_vec_1900.first_vec39 as first_vec39_1900, first_vec_1900.first_vec40 as first_vec40_1900, first_vec_1900.first_vec41 as first_vec41_1900, first_vec_1900.first_vec42 as first_vec42_1900, first_vec_1900.first_vec43 as first_vec43_1900, first_vec_1900.first_vec44 as first_vec44_1900, first_vec_1900.first_vec45 as first_vec45_1900, first_vec_1900.first_vec46 as first_vec46_1900, first_vec_1900.first_vec47 as first_vec47_1900, first_vec_1900.first_vec48 as first_vec48_1900, first_vec_1900.first_vec49 as first_vec49_1900, first_vec_1900.first_vec50 as first_vec50_1900, first_vec_1900.first_vec51 as first_vec51_1900, first_vec_1900.first_vec52 as first_vec52_1900, first_vec_1900.first_vec53 as first_vec53_1900, first_vec_1900.first_vec54 as first_vec54_1900, first_vec_1900.first_vec55 as first_vec55_1900, first_vec_1900.first_vec56 as first_vec56_1900, first_vec_1900.first_vec57 as first_vec57_1900, first_vec_1900.first_vec58 as first_vec58_1900, first_vec_1900.first_vec59 as first_vec59_1900, first_vec_1900.first_vec60 as first_vec60_1900, first_vec_1900.first_vec61 as first_vec61_1900, first_vec_1900.first_vec62 as first_vec62_1900, first_vec_1900.first_vec63 as first_vec63_1900, first_vec_1900.first_vec64 as first_vec64_1900, first_vec_1900.first_vec65 as first_vec65_1900, first_vec_1900.first_vec66 as first_vec66_1900, first_vec_1900.first_vec67 as first_vec67_1900, first_vec_1900.first_vec68 as first_vec68_1900, first_vec_1900.first_vec69 as first_vec69_1900, first_vec_1900.first_vec70 as first_vec70_1900, first_vec_1900.first_vec71 as first_vec71_1900, first_vec_1900.first_vec72 as first_vec72_1900, first_vec_1900.first_vec73 as first_vec73_1900, first_vec_1900.first_vec74 as first_vec74_1900, first_vec_1900.first_vec75 as first_vec75_1900, first_vec_1900.first_vec76 as first_vec76_1900, first_vec_1900.first_vec77 as first_vec77_1900, first_vec_1900.first_vec78 as first_vec78_1900, first_vec_1900.first_vec79 as first_vec79_1900, first_vec_1900.first_vec80 as first_vec80_1900, first_vec_1900.first_vec81 as first_vec81_1900, first_vec_1900.first_vec82 as first_vec82_1900, first_vec_1900.first_vec83 as first_vec83_1900, first_vec_1900.first_vec84 as first_vec84_1900, first_vec_1900.first_vec85 as first_vec85_1900, first_vec_1900.first_vec86 as first_vec86_1900, first_vec_1900.first_vec87 as first_vec87_1900, first_vec_1900.first_vec88 as first_vec88_1900, first_vec_1900.first_vec89 as first_vec89_1900, first_vec_1900.first_vec90 as first_vec90_1900, first_vec_1900.first_vec91 as first_vec91_1900, first_vec_1900.first_vec92 as first_vec92_1900, first_vec_1900.first_vec93 as first_vec93_1900, first_vec_1900.first_vec94 as first_vec94_1900, first_vec_1900.first_vec95 as first_vec95_1900, first_vec_1900.first_vec96 as first_vec96_1900, first_vec_1900.first_vec97 as first_vec97_1900, first_vec_1900.first_vec98 as first_vec98_1900, first_vec_1900.first_vec99 as first_vec99_1900, first_vec_1900.first_vec100 as first_vec100_1900, first_vec_1900.first_vec101 as first_vec101_1900, first_vec_1900.first_vec102 as first_vec102_1900, first_vec_1900.first_vec103 as first_vec103_1900, first_vec_1900.first_vec104 as first_vec104_1900, first_vec_1900.first_vec105 as first_vec105_1900, first_vec_1900.first_vec106 as first_vec106_1900, first_vec_1900.first_vec107 as first_vec107_1900, first_vec_1900.first_vec108 as first_vec108_1900, first_vec_1900.first_vec109 as first_vec109_1900, first_vec_1900.first_vec110 as first_vec110_1900, first_vec_1900.first_vec111 as first_vec111_1900, first_vec_1900.first_vec112 as first_vec112_1900, first_vec_1900.first_vec113 as first_vec113_1900, first_vec_1900.first_vec114 as first_vec114_1900, first_vec_1900.first_vec115 as first_vec115_1900, first_vec_1900.first_vec116 as first_vec116_1900, first_vec_1900.first_vec117 as first_vec117_1900, first_vec_1900.first_vec118 as first_vec118_1900, first_vec_1900.first_vec119 as first_vec119_1900, first_vec_1900.first_vec120 as first_vec120_1900, first_vec_1900.first_vec121 as first_vec121_1900, first_vec_1900.first_vec122 as first_vec122_1900, first_vec_1900.first_vec123 as first_vec123_1900, first_vec_1900.first_vec124 as first_vec124_1900, first_vec_1900.first_vec125 as first_vec125_1900, first_vec_1900.first_vec126 as first_vec126_1900, first_vec_1900.first_vec127 as first_vec127_1900, first_vec_1900.first_vec128 as first_vec128_1900, first_vec_1900.first_vec129 as first_vec129_1900, first_vec_1900.first_vec130 as first_vec130_1900, first_vec_1900.first_vec131 as first_vec131_1900, first_vec_1900.first_vec132 as first_vec132_1900, first_vec_1900.first_vec133 as first_vec133_1900, first_vec_1900.first_vec134 as first_vec134_1900, first_vec_1900.first_vec135 as first_vec135_1900, first_vec_1900.first_vec136 as first_vec136_1900, first_vec_1900.first_vec137 as first_vec137_1900, first_vec_1900.first_vec138 as first_vec138_1900, first_vec_1900.first_vec139 as first_vec139_1900, first_vec_1900.first_vec140 as first_vec140_1900, first_vec_1900.first_vec141 as first_vec141_1900, first_vec_1900.first_vec142 as first_vec142_1900, first_vec_1900.first_vec143 as first_vec143_1900, first_vec_1900.first_vec144 as first_vec144_1900, first_vec_1900.first_vec145 as first_vec145_1900, first_vec_1900.first_vec146 as first_vec146_1900, first_vec_1900.first_vec147 as first_vec147_1900, first_vec_1900.first_vec148 as first_vec148_1900, first_vec_1900.first_vec149 as first_vec149_1900, first_vec_1900.first_vec150 as first_vec150_1900, first_vec_1900.first_vec151 as first_vec151_1900, first_vec_1900.first_vec152 as first_vec152_1900, first_vec_1900.first_vec153 as first_vec153_1900, first_vec_1900.first_vec154 as first_vec154_1900, first_vec_1900.first_vec155 as first_vec155_1900, first_vec_1900.first_vec156 as first_vec156_1900, first_vec_1900.first_vec157 as first_vec157_1900, first_vec_1900.first_vec158 as first_vec158_1900, first_vec_1900.first_vec159 as first_vec159_1900, first_vec_1900.first_vec160 as first_vec160_1900, first_vec_1900.first_vec161 as first_vec161_1900, first_vec_1900.first_vec162 as first_vec162_1900, first_vec_1900.first_vec163 as first_vec163_1900, first_vec_1900.first_vec164 as first_vec164_1900, first_vec_1900.first_vec165 as first_vec165_1900, first_vec_1900.first_vec166 as first_vec166_1900, first_vec_1900.first_vec167 as first_vec167_1900, first_vec_1900.first_vec168 as first_vec168_1900, first_vec_1900.first_vec169 as first_vec169_1900, first_vec_1900.first_vec170 as first_vec170_1900, first_vec_1900.first_vec171 as first_vec171_1900, first_vec_1900.first_vec172 as first_vec172_1900, first_vec_1900.first_vec173 as first_vec173_1900, first_vec_1900.first_vec174 as first_vec174_1900, first_vec_1900.first_vec175 as first_vec175_1900, first_vec_1900.first_vec176 as first_vec176_1900, first_vec_1900.first_vec177 as first_vec177_1900, first_vec_1900.first_vec178 as first_vec178_1900, first_vec_1900.first_vec179 as first_vec179_1900, first_vec_1900.first_vec180 as first_vec180_1900, first_vec_1900.first_vec181 as first_vec181_1900, first_vec_1900.first_vec182 as first_vec182_1900, first_vec_1900.first_vec183 as first_vec183_1900, first_vec_1900.first_vec184 as first_vec184_1900, first_vec_1900.first_vec185 as first_vec185_1900, first_vec_1900.first_vec186 as first_vec186_1900, first_vec_1900.first_vec187 as first_vec187_1900, first_vec_1900.first_vec188 as first_vec188_1900, first_vec_1900.first_vec189 as first_vec189_1900, first_vec_1900.first_vec190 as first_vec190_1900, first_vec_1900.first_vec191 as first_vec191_1900, first_vec_1900.first_vec192 as first_vec192_1900, first_vec_1900.first_vec193 as first_vec193_1900, first_vec_1900.first_vec194 as first_vec194_1900, first_vec_1900.first_vec195 as first_vec195_1900, first_vec_1900.first_vec196 as first_vec196_1900, first_vec_1900.first_vec197 as first_vec197_1900, first_vec_1900.first_vec198 as first_vec198_1900, first_vec_1900.first_vec199 as first_vec199_1900, first_vec_1900.first_vec200 as first_vec200_1900, first_vec_1900.first_vec201 as first_vec201_1900, 
	   last_vec_1900.last_vec2 as last_vec2_1900, last_vec_1900.last_vec3 as last_vec3_1900, last_vec_1900.last_vec4 as last_vec4_1900, last_vec_1900.last_vec5 as last_vec5_1900, last_vec_1900.last_vec6 as last_vec6_1900, last_vec_1900.last_vec7 as last_vec7_1900, last_vec_1900.last_vec8 as last_vec8_1900, last_vec_1900.last_vec9 as last_vec9_1900, last_vec_1900.last_vec10 as last_vec10_1900, last_vec_1900.last_vec11 as last_vec11_1900, last_vec_1900.last_vec12 as last_vec12_1900, last_vec_1900.last_vec13 as last_vec13_1900, last_vec_1900.last_vec14 as last_vec14_1900, last_vec_1900.last_vec15 as last_vec15_1900, last_vec_1900.last_vec16 as last_vec16_1900, last_vec_1900.last_vec17 as last_vec17_1900, last_vec_1900.last_vec18 as last_vec18_1900, last_vec_1900.last_vec19 as last_vec19_1900, last_vec_1900.last_vec20 as last_vec20_1900, last_vec_1900.last_vec21 as last_vec21_1900, last_vec_1900.last_vec22 as last_vec22_1900, last_vec_1900.last_vec23 as last_vec23_1900, last_vec_1900.last_vec24 as last_vec24_1900, last_vec_1900.last_vec25 as last_vec25_1900, last_vec_1900.last_vec26 as last_vec26_1900, last_vec_1900.last_vec27 as last_vec27_1900, last_vec_1900.last_vec28 as last_vec28_1900, last_vec_1900.last_vec29 as last_vec29_1900, last_vec_1900.last_vec30 as last_vec30_1900, last_vec_1900.last_vec31 as last_vec31_1900, last_vec_1900.last_vec32 as last_vec32_1900, last_vec_1900.last_vec33 as last_vec33_1900, last_vec_1900.last_vec34 as last_vec34_1900, last_vec_1900.last_vec35 as last_vec35_1900, last_vec_1900.last_vec36 as last_vec36_1900, last_vec_1900.last_vec37 as last_vec37_1900, last_vec_1900.last_vec38 as last_vec38_1900, last_vec_1900.last_vec39 as last_vec39_1900, last_vec_1900.last_vec40 as last_vec40_1900, last_vec_1900.last_vec41 as last_vec41_1900, last_vec_1900.last_vec42 as last_vec42_1900, last_vec_1900.last_vec43 as last_vec43_1900, last_vec_1900.last_vec44 as last_vec44_1900, last_vec_1900.last_vec45 as last_vec45_1900, last_vec_1900.last_vec46 as last_vec46_1900, last_vec_1900.last_vec47 as last_vec47_1900, last_vec_1900.last_vec48 as last_vec48_1900, last_vec_1900.last_vec49 as last_vec49_1900, last_vec_1900.last_vec50 as last_vec50_1900, last_vec_1900.last_vec51 as last_vec51_1900, last_vec_1900.last_vec52 as last_vec52_1900, last_vec_1900.last_vec53 as last_vec53_1900, last_vec_1900.last_vec54 as last_vec54_1900, last_vec_1900.last_vec55 as last_vec55_1900, last_vec_1900.last_vec56 as last_vec56_1900, last_vec_1900.last_vec57 as last_vec57_1900, last_vec_1900.last_vec58 as last_vec58_1900, last_vec_1900.last_vec59 as last_vec59_1900, last_vec_1900.last_vec60 as last_vec60_1900, last_vec_1900.last_vec61 as last_vec61_1900, last_vec_1900.last_vec62 as last_vec62_1900, last_vec_1900.last_vec63 as last_vec63_1900, last_vec_1900.last_vec64 as last_vec64_1900, last_vec_1900.last_vec65 as last_vec65_1900, last_vec_1900.last_vec66 as last_vec66_1900, last_vec_1900.last_vec67 as last_vec67_1900, last_vec_1900.last_vec68 as last_vec68_1900, last_vec_1900.last_vec69 as last_vec69_1900, last_vec_1900.last_vec70 as last_vec70_1900, last_vec_1900.last_vec71 as last_vec71_1900, last_vec_1900.last_vec72 as last_vec72_1900, last_vec_1900.last_vec73 as last_vec73_1900, last_vec_1900.last_vec74 as last_vec74_1900, last_vec_1900.last_vec75 as last_vec75_1900, last_vec_1900.last_vec76 as last_vec76_1900, last_vec_1900.last_vec77 as last_vec77_1900, last_vec_1900.last_vec78 as last_vec78_1900, last_vec_1900.last_vec79 as last_vec79_1900, last_vec_1900.last_vec80 as last_vec80_1900, last_vec_1900.last_vec81 as last_vec81_1900, last_vec_1900.last_vec82 as last_vec82_1900, last_vec_1900.last_vec83 as last_vec83_1900, last_vec_1900.last_vec84 as last_vec84_1900, last_vec_1900.last_vec85 as last_vec85_1900, last_vec_1900.last_vec86 as last_vec86_1900, last_vec_1900.last_vec87 as last_vec87_1900, last_vec_1900.last_vec88 as last_vec88_1900, last_vec_1900.last_vec89 as last_vec89_1900, last_vec_1900.last_vec90 as last_vec90_1900, last_vec_1900.last_vec91 as last_vec91_1900, last_vec_1900.last_vec92 as last_vec92_1900, last_vec_1900.last_vec93 as last_vec93_1900, last_vec_1900.last_vec94 as last_vec94_1900, last_vec_1900.last_vec95 as last_vec95_1900, last_vec_1900.last_vec96 as last_vec96_1900, last_vec_1900.last_vec97 as last_vec97_1900, last_vec_1900.last_vec98 as last_vec98_1900, last_vec_1900.last_vec99 as last_vec99_1900, last_vec_1900.last_vec100 as last_vec100_1900, last_vec_1900.last_vec101 as last_vec101_1900, last_vec_1900.last_vec102 as last_vec102_1900, last_vec_1900.last_vec103 as last_vec103_1900, last_vec_1900.last_vec104 as last_vec104_1900, last_vec_1900.last_vec105 as last_vec105_1900, last_vec_1900.last_vec106 as last_vec106_1900, last_vec_1900.last_vec107 as last_vec107_1900, last_vec_1900.last_vec108 as last_vec108_1900, last_vec_1900.last_vec109 as last_vec109_1900, last_vec_1900.last_vec110 as last_vec110_1900, last_vec_1900.last_vec111 as last_vec111_1900, last_vec_1900.last_vec112 as last_vec112_1900, last_vec_1900.last_vec113 as last_vec113_1900, last_vec_1900.last_vec114 as last_vec114_1900, last_vec_1900.last_vec115 as last_vec115_1900, last_vec_1900.last_vec116 as last_vec116_1900, last_vec_1900.last_vec117 as last_vec117_1900, last_vec_1900.last_vec118 as last_vec118_1900, last_vec_1900.last_vec119 as last_vec119_1900, last_vec_1900.last_vec120 as last_vec120_1900, last_vec_1900.last_vec121 as last_vec121_1900, last_vec_1900.last_vec122 as last_vec122_1900, last_vec_1900.last_vec123 as last_vec123_1900, last_vec_1900.last_vec124 as last_vec124_1900, last_vec_1900.last_vec125 as last_vec125_1900, last_vec_1900.last_vec126 as last_vec126_1900, last_vec_1900.last_vec127 as last_vec127_1900, last_vec_1900.last_vec128 as last_vec128_1900, last_vec_1900.last_vec129 as last_vec129_1900, last_vec_1900.last_vec130 as last_vec130_1900, last_vec_1900.last_vec131 as last_vec131_1900, last_vec_1900.last_vec132 as last_vec132_1900, last_vec_1900.last_vec133 as last_vec133_1900, last_vec_1900.last_vec134 as last_vec134_1900, last_vec_1900.last_vec135 as last_vec135_1900, last_vec_1900.last_vec136 as last_vec136_1900, last_vec_1900.last_vec137 as last_vec137_1900, last_vec_1900.last_vec138 as last_vec138_1900, last_vec_1900.last_vec139 as last_vec139_1900, last_vec_1900.last_vec140 as last_vec140_1900, last_vec_1900.last_vec141 as last_vec141_1900, last_vec_1900.last_vec142 as last_vec142_1900, last_vec_1900.last_vec143 as last_vec143_1900, last_vec_1900.last_vec144 as last_vec144_1900, last_vec_1900.last_vec145 as last_vec145_1900, last_vec_1900.last_vec146 as last_vec146_1900, last_vec_1900.last_vec147 as last_vec147_1900, last_vec_1900.last_vec148 as last_vec148_1900, last_vec_1900.last_vec149 as last_vec149_1900, last_vec_1900.last_vec150 as last_vec150_1900, last_vec_1900.last_vec151 as last_vec151_1900, last_vec_1900.last_vec152 as last_vec152_1900, last_vec_1900.last_vec153 as last_vec153_1900, last_vec_1900.last_vec154 as last_vec154_1900, last_vec_1900.last_vec155 as last_vec155_1900, last_vec_1900.last_vec156 as last_vec156_1900, last_vec_1900.last_vec157 as last_vec157_1900, last_vec_1900.last_vec158 as last_vec158_1900, last_vec_1900.last_vec159 as last_vec159_1900, last_vec_1900.last_vec160 as last_vec160_1900, last_vec_1900.last_vec161 as last_vec161_1900, last_vec_1900.last_vec162 as last_vec162_1900, last_vec_1900.last_vec163 as last_vec163_1900, last_vec_1900.last_vec164 as last_vec164_1900, last_vec_1900.last_vec165 as last_vec165_1900, last_vec_1900.last_vec166 as last_vec166_1900, last_vec_1900.last_vec167 as last_vec167_1900, last_vec_1900.last_vec168 as last_vec168_1900, last_vec_1900.last_vec169 as last_vec169_1900, last_vec_1900.last_vec170 as last_vec170_1900, last_vec_1900.last_vec171 as last_vec171_1900, last_vec_1900.last_vec172 as last_vec172_1900, last_vec_1900.last_vec173 as last_vec173_1900, last_vec_1900.last_vec174 as last_vec174_1900, last_vec_1900.last_vec175 as last_vec175_1900, last_vec_1900.last_vec176 as last_vec176_1900, last_vec_1900.last_vec177 as last_vec177_1900, last_vec_1900.last_vec178 as last_vec178_1900, last_vec_1900.last_vec179 as last_vec179_1900, last_vec_1900.last_vec180 as last_vec180_1900, last_vec_1900.last_vec181 as last_vec181_1900, last_vec_1900.last_vec182 as last_vec182_1900, last_vec_1900.last_vec183 as last_vec183_1900, last_vec_1900.last_vec184 as last_vec184_1900, last_vec_1900.last_vec185 as last_vec185_1900, last_vec_1900.last_vec186 as last_vec186_1900, last_vec_1900.last_vec187 as last_vec187_1900, last_vec_1900.last_vec188 as last_vec188_1900, last_vec_1900.last_vec189 as last_vec189_1900, last_vec_1900.last_vec190 as last_vec190_1900, last_vec_1900.last_vec191 as last_vec191_1900, last_vec_1900.last_vec192 as last_vec192_1900, last_vec_1900.last_vec193 as last_vec193_1900, last_vec_1900.last_vec194 as last_vec194_1900, last_vec_1900.last_vec195 as last_vec195_1900, last_vec_1900.last_vec196 as last_vec196_1900, last_vec_1900.last_vec197 as last_vec197_1900, last_vec_1900.last_vec198 as last_vec198_1900, last_vec_1900.last_vec199 as last_vec199_1900, last_vec_1900.last_vec200 as last_vec200_1900, last_vec_1900.last_vec201 as last_vec201_1900,
	   census_1910.index_1910, census_1910.marstat_1910, census_1910.birth_year_1910, census_1910.household_1910, census_1910.immigration_1910, census_1910.race_1910, census_1910.rel_1910,
	   census_1910.female_1910, census_1910.bp_1910, census_1910.mbp_1910, census_1910.fbp_1910, census_1910.state_1910, census_1910.county_1910, census_1910.cohort1_1910,
	   census_1910.cohort2_1910, census_1910.last_sdxn_1910, census_1910.first_sdxn_1910, census_1910.last_init_1910, census_1910.first_init_1910, 
	   bplace_comm_1910.bp_comm_1910 as bp_comm_1900, first_comm_1910.first_comm_1910, last_comm_1910.last_comm_1910,
	   stringnames_1910.first_1910, stringnames_1910.last_1910,
	   geo_bplace_1910.bp_lat as bp_lat_1910, geo_bplace_1910.bp_lon as bp_lon_1910,
	   geo_res_1910.res_lat as res_lat_1910, geo_res_1910.res_lon as res_lon_1910,
	   nickname_1910.full_name as full_name_1910,
	   first_vec_1910.first_vec2 as first_vec2_1910, first_vec_1910.first_vec3 as first_vec3_1910, first_vec_1910.first_vec4 as first_vec4_1910, first_vec_1910.first_vec5 as first_vec5_1910, first_vec_1910.first_vec6 as first_vec6_1910, first_vec_1910.first_vec7 as first_vec7_1910, first_vec_1910.first_vec8 as first_vec8_1910, first_vec_1910.first_vec9 as first_vec9_1910, first_vec_1910.first_vec10 as first_vec10_1910, first_vec_1910.first_vec11 as first_vec11_1910, first_vec_1910.first_vec12 as first_vec12_1910, first_vec_1910.first_vec13 as first_vec13_1910, first_vec_1910.first_vec14 as first_vec14_1910, first_vec_1910.first_vec15 as first_vec15_1910, first_vec_1910.first_vec16 as first_vec16_1910, first_vec_1910.first_vec17 as first_vec17_1910, first_vec_1910.first_vec18 as first_vec18_1910, first_vec_1910.first_vec19 as first_vec19_1910, first_vec_1910.first_vec20 as first_vec20_1910, first_vec_1910.first_vec21 as first_vec21_1910, first_vec_1910.first_vec22 as first_vec22_1910, first_vec_1910.first_vec23 as first_vec23_1910, first_vec_1910.first_vec24 as first_vec24_1910, first_vec_1910.first_vec25 as first_vec25_1910, first_vec_1910.first_vec26 as first_vec26_1910, first_vec_1910.first_vec27 as first_vec27_1910, first_vec_1910.first_vec28 as first_vec28_1910, first_vec_1910.first_vec29 as first_vec29_1910, first_vec_1910.first_vec30 as first_vec30_1910, first_vec_1910.first_vec31 as first_vec31_1910, first_vec_1910.first_vec32 as first_vec32_1910, first_vec_1910.first_vec33 as first_vec33_1910, first_vec_1910.first_vec34 as first_vec34_1910, first_vec_1910.first_vec35 as first_vec35_1910, first_vec_1910.first_vec36 as first_vec36_1910, first_vec_1910.first_vec37 as first_vec37_1910, first_vec_1910.first_vec38 as first_vec38_1910, first_vec_1910.first_vec39 as first_vec39_1910, first_vec_1910.first_vec40 as first_vec40_1910, first_vec_1910.first_vec41 as first_vec41_1910, first_vec_1910.first_vec42 as first_vec42_1910, first_vec_1910.first_vec43 as first_vec43_1910, first_vec_1910.first_vec44 as first_vec44_1910, first_vec_1910.first_vec45 as first_vec45_1910, first_vec_1910.first_vec46 as first_vec46_1910, first_vec_1910.first_vec47 as first_vec47_1910, first_vec_1910.first_vec48 as first_vec48_1910, first_vec_1910.first_vec49 as first_vec49_1910, first_vec_1910.first_vec50 as first_vec50_1910, first_vec_1910.first_vec51 as first_vec51_1910, first_vec_1910.first_vec52 as first_vec52_1910, first_vec_1910.first_vec53 as first_vec53_1910, first_vec_1910.first_vec54 as first_vec54_1910, first_vec_1910.first_vec55 as first_vec55_1910, first_vec_1910.first_vec56 as first_vec56_1910, first_vec_1910.first_vec57 as first_vec57_1910, first_vec_1910.first_vec58 as first_vec58_1910, first_vec_1910.first_vec59 as first_vec59_1910, first_vec_1910.first_vec60 as first_vec60_1910, first_vec_1910.first_vec61 as first_vec61_1910, first_vec_1910.first_vec62 as first_vec62_1910, first_vec_1910.first_vec63 as first_vec63_1910, first_vec_1910.first_vec64 as first_vec64_1910, first_vec_1910.first_vec65 as first_vec65_1910, first_vec_1910.first_vec66 as first_vec66_1910, first_vec_1910.first_vec67 as first_vec67_1910, first_vec_1910.first_vec68 as first_vec68_1910, first_vec_1910.first_vec69 as first_vec69_1910, first_vec_1910.first_vec70 as first_vec70_1910, first_vec_1910.first_vec71 as first_vec71_1910, first_vec_1910.first_vec72 as first_vec72_1910, first_vec_1910.first_vec73 as first_vec73_1910, first_vec_1910.first_vec74 as first_vec74_1910, first_vec_1910.first_vec75 as first_vec75_1910, first_vec_1910.first_vec76 as first_vec76_1910, first_vec_1910.first_vec77 as first_vec77_1910, first_vec_1910.first_vec78 as first_vec78_1910, first_vec_1910.first_vec79 as first_vec79_1910, first_vec_1910.first_vec80 as first_vec80_1910, first_vec_1910.first_vec81 as first_vec81_1910, first_vec_1910.first_vec82 as first_vec82_1910, first_vec_1910.first_vec83 as first_vec83_1910, first_vec_1910.first_vec84 as first_vec84_1910, first_vec_1910.first_vec85 as first_vec85_1910, first_vec_1910.first_vec86 as first_vec86_1910, first_vec_1910.first_vec87 as first_vec87_1910, first_vec_1910.first_vec88 as first_vec88_1910, first_vec_1910.first_vec89 as first_vec89_1910, first_vec_1910.first_vec90 as first_vec90_1910, first_vec_1910.first_vec91 as first_vec91_1910, first_vec_1910.first_vec92 as first_vec92_1910, first_vec_1910.first_vec93 as first_vec93_1910, first_vec_1910.first_vec94 as first_vec94_1910, first_vec_1910.first_vec95 as first_vec95_1910, first_vec_1910.first_vec96 as first_vec96_1910, first_vec_1910.first_vec97 as first_vec97_1910, first_vec_1910.first_vec98 as first_vec98_1910, first_vec_1910.first_vec99 as first_vec99_1910, first_vec_1910.first_vec100 as first_vec100_1910, first_vec_1910.first_vec101 as first_vec101_1910, first_vec_1910.first_vec102 as first_vec102_1910, first_vec_1910.first_vec103 as first_vec103_1910, first_vec_1910.first_vec104 as first_vec104_1910, first_vec_1910.first_vec105 as first_vec105_1910, first_vec_1910.first_vec106 as first_vec106_1910, first_vec_1910.first_vec107 as first_vec107_1910, first_vec_1910.first_vec108 as first_vec108_1910, first_vec_1910.first_vec109 as first_vec109_1910, first_vec_1910.first_vec110 as first_vec110_1910, first_vec_1910.first_vec111 as first_vec111_1910, first_vec_1910.first_vec112 as first_vec112_1910, first_vec_1910.first_vec113 as first_vec113_1910, first_vec_1910.first_vec114 as first_vec114_1910, first_vec_1910.first_vec115 as first_vec115_1910, first_vec_1910.first_vec116 as first_vec116_1910, first_vec_1910.first_vec117 as first_vec117_1910, first_vec_1910.first_vec118 as first_vec118_1910, first_vec_1910.first_vec119 as first_vec119_1910, first_vec_1910.first_vec120 as first_vec120_1910, first_vec_1910.first_vec121 as first_vec121_1910, first_vec_1910.first_vec122 as first_vec122_1910, first_vec_1910.first_vec123 as first_vec123_1910, first_vec_1910.first_vec124 as first_vec124_1910, first_vec_1910.first_vec125 as first_vec125_1910, first_vec_1910.first_vec126 as first_vec126_1910, first_vec_1910.first_vec127 as first_vec127_1910, first_vec_1910.first_vec128 as first_vec128_1910, first_vec_1910.first_vec129 as first_vec129_1910, first_vec_1910.first_vec130 as first_vec130_1910, first_vec_1910.first_vec131 as first_vec131_1910, first_vec_1910.first_vec132 as first_vec132_1910, first_vec_1910.first_vec133 as first_vec133_1910, first_vec_1910.first_vec134 as first_vec134_1910, first_vec_1910.first_vec135 as first_vec135_1910, first_vec_1910.first_vec136 as first_vec136_1910, first_vec_1910.first_vec137 as first_vec137_1910, first_vec_1910.first_vec138 as first_vec138_1910, first_vec_1910.first_vec139 as first_vec139_1910, first_vec_1910.first_vec140 as first_vec140_1910, first_vec_1910.first_vec141 as first_vec141_1910, first_vec_1910.first_vec142 as first_vec142_1910, first_vec_1910.first_vec143 as first_vec143_1910, first_vec_1910.first_vec144 as first_vec144_1910, first_vec_1910.first_vec145 as first_vec145_1910, first_vec_1910.first_vec146 as first_vec146_1910, first_vec_1910.first_vec147 as first_vec147_1910, first_vec_1910.first_vec148 as first_vec148_1910, first_vec_1910.first_vec149 as first_vec149_1910, first_vec_1910.first_vec150 as first_vec150_1910, first_vec_1910.first_vec151 as first_vec151_1910, first_vec_1910.first_vec152 as first_vec152_1910, first_vec_1910.first_vec153 as first_vec153_1910, first_vec_1910.first_vec154 as first_vec154_1910, first_vec_1910.first_vec155 as first_vec155_1910, first_vec_1910.first_vec156 as first_vec156_1910, first_vec_1910.first_vec157 as first_vec157_1910, first_vec_1910.first_vec158 as first_vec158_1910, first_vec_1910.first_vec159 as first_vec159_1910, first_vec_1910.first_vec160 as first_vec160_1910, first_vec_1910.first_vec161 as first_vec161_1910, first_vec_1910.first_vec162 as first_vec162_1910, first_vec_1910.first_vec163 as first_vec163_1910, first_vec_1910.first_vec164 as first_vec164_1910, first_vec_1910.first_vec165 as first_vec165_1910, first_vec_1910.first_vec166 as first_vec166_1910, first_vec_1910.first_vec167 as first_vec167_1910, first_vec_1910.first_vec168 as first_vec168_1910, first_vec_1910.first_vec169 as first_vec169_1910, first_vec_1910.first_vec170 as first_vec170_1910, first_vec_1910.first_vec171 as first_vec171_1910, first_vec_1910.first_vec172 as first_vec172_1910, first_vec_1910.first_vec173 as first_vec173_1910, first_vec_1910.first_vec174 as first_vec174_1910, first_vec_1910.first_vec175 as first_vec175_1910, first_vec_1910.first_vec176 as first_vec176_1910, first_vec_1910.first_vec177 as first_vec177_1910, first_vec_1910.first_vec178 as first_vec178_1910, first_vec_1910.first_vec179 as first_vec179_1910, first_vec_1910.first_vec180 as first_vec180_1910, first_vec_1910.first_vec181 as first_vec181_1910, first_vec_1910.first_vec182 as first_vec182_1910, first_vec_1910.first_vec183 as first_vec183_1910, first_vec_1910.first_vec184 as first_vec184_1910, first_vec_1910.first_vec185 as first_vec185_1910, first_vec_1910.first_vec186 as first_vec186_1910, first_vec_1910.first_vec187 as first_vec187_1910, first_vec_1910.first_vec188 as first_vec188_1910, first_vec_1910.first_vec189 as first_vec189_1910, first_vec_1910.first_vec190 as first_vec190_1910, first_vec_1910.first_vec191 as first_vec191_1910, first_vec_1910.first_vec192 as first_vec192_1910, first_vec_1910.first_vec193 as first_vec193_1910, first_vec_1910.first_vec194 as first_vec194_1910, first_vec_1910.first_vec195 as first_vec195_1910, first_vec_1910.first_vec196 as first_vec196_1910, first_vec_1910.first_vec197 as first_vec197_1910, first_vec_1910.first_vec198 as first_vec198_1910, first_vec_1910.first_vec199 as first_vec199_1910, first_vec_1910.first_vec200 as first_vec200_1910, first_vec_1910.first_vec201 as first_vec201_1910, 
	   last_vec_1910.last_vec2 as last_vec2_1910, last_vec_1910.last_vec3 as last_vec3_1910, last_vec_1910.last_vec4 as last_vec4_1910, last_vec_1910.last_vec5 as last_vec5_1910, last_vec_1910.last_vec6 as last_vec6_1910, last_vec_1910.last_vec7 as last_vec7_1910, last_vec_1910.last_vec8 as last_vec8_1910, last_vec_1910.last_vec9 as last_vec9_1910, last_vec_1910.last_vec10 as last_vec10_1910, last_vec_1910.last_vec11 as last_vec11_1910, last_vec_1910.last_vec12 as last_vec12_1910, last_vec_1910.last_vec13 as last_vec13_1910, last_vec_1910.last_vec14 as last_vec14_1910, last_vec_1910.last_vec15 as last_vec15_1910, last_vec_1910.last_vec16 as last_vec16_1910, last_vec_1910.last_vec17 as last_vec17_1910, last_vec_1910.last_vec18 as last_vec18_1910, last_vec_1910.last_vec19 as last_vec19_1910, last_vec_1910.last_vec20 as last_vec20_1910, last_vec_1910.last_vec21 as last_vec21_1910, last_vec_1910.last_vec22 as last_vec22_1910, last_vec_1910.last_vec23 as last_vec23_1910, last_vec_1910.last_vec24 as last_vec24_1910, last_vec_1910.last_vec25 as last_vec25_1910, last_vec_1910.last_vec26 as last_vec26_1910, last_vec_1910.last_vec27 as last_vec27_1910, last_vec_1910.last_vec28 as last_vec28_1910, last_vec_1910.last_vec29 as last_vec29_1910, last_vec_1910.last_vec30 as last_vec30_1910, last_vec_1910.last_vec31 as last_vec31_1910, last_vec_1910.last_vec32 as last_vec32_1910, last_vec_1910.last_vec33 as last_vec33_1910, last_vec_1910.last_vec34 as last_vec34_1910, last_vec_1910.last_vec35 as last_vec35_1910, last_vec_1910.last_vec36 as last_vec36_1910, last_vec_1910.last_vec37 as last_vec37_1910, last_vec_1910.last_vec38 as last_vec38_1910, last_vec_1910.last_vec39 as last_vec39_1910, last_vec_1910.last_vec40 as last_vec40_1910, last_vec_1910.last_vec41 as last_vec41_1910, last_vec_1910.last_vec42 as last_vec42_1910, last_vec_1910.last_vec43 as last_vec43_1910, last_vec_1910.last_vec44 as last_vec44_1910, last_vec_1910.last_vec45 as last_vec45_1910, last_vec_1910.last_vec46 as last_vec46_1910, last_vec_1910.last_vec47 as last_vec47_1910, last_vec_1910.last_vec48 as last_vec48_1910, last_vec_1910.last_vec49 as last_vec49_1910, last_vec_1910.last_vec50 as last_vec50_1910, last_vec_1910.last_vec51 as last_vec51_1910, last_vec_1910.last_vec52 as last_vec52_1910, last_vec_1910.last_vec53 as last_vec53_1910, last_vec_1910.last_vec54 as last_vec54_1910, last_vec_1910.last_vec55 as last_vec55_1910, last_vec_1910.last_vec56 as last_vec56_1910, last_vec_1910.last_vec57 as last_vec57_1910, last_vec_1910.last_vec58 as last_vec58_1910, last_vec_1910.last_vec59 as last_vec59_1910, last_vec_1910.last_vec60 as last_vec60_1910, last_vec_1910.last_vec61 as last_vec61_1910, last_vec_1910.last_vec62 as last_vec62_1910, last_vec_1910.last_vec63 as last_vec63_1910, last_vec_1910.last_vec64 as last_vec64_1910, last_vec_1910.last_vec65 as last_vec65_1910, last_vec_1910.last_vec66 as last_vec66_1910, last_vec_1910.last_vec67 as last_vec67_1910, last_vec_1910.last_vec68 as last_vec68_1910, last_vec_1910.last_vec69 as last_vec69_1910, last_vec_1910.last_vec70 as last_vec70_1910, last_vec_1910.last_vec71 as last_vec71_1910, last_vec_1910.last_vec72 as last_vec72_1910, last_vec_1910.last_vec73 as last_vec73_1910, last_vec_1910.last_vec74 as last_vec74_1910, last_vec_1910.last_vec75 as last_vec75_1910, last_vec_1910.last_vec76 as last_vec76_1910, last_vec_1910.last_vec77 as last_vec77_1910, last_vec_1910.last_vec78 as last_vec78_1910, last_vec_1910.last_vec79 as last_vec79_1910, last_vec_1910.last_vec80 as last_vec80_1910, last_vec_1910.last_vec81 as last_vec81_1910, last_vec_1910.last_vec82 as last_vec82_1910, last_vec_1910.last_vec83 as last_vec83_1910, last_vec_1910.last_vec84 as last_vec84_1910, last_vec_1910.last_vec85 as last_vec85_1910, last_vec_1910.last_vec86 as last_vec86_1910, last_vec_1910.last_vec87 as last_vec87_1910, last_vec_1910.last_vec88 as last_vec88_1910, last_vec_1910.last_vec89 as last_vec89_1910, last_vec_1910.last_vec90 as last_vec90_1910, last_vec_1910.last_vec91 as last_vec91_1910, last_vec_1910.last_vec92 as last_vec92_1910, last_vec_1910.last_vec93 as last_vec93_1910, last_vec_1910.last_vec94 as last_vec94_1910, last_vec_1910.last_vec95 as last_vec95_1910, last_vec_1910.last_vec96 as last_vec96_1910, last_vec_1910.last_vec97 as last_vec97_1910, last_vec_1910.last_vec98 as last_vec98_1910, last_vec_1910.last_vec99 as last_vec99_1910, last_vec_1910.last_vec100 as last_vec100_1910, last_vec_1910.last_vec101 as last_vec101_1910, last_vec_1910.last_vec102 as last_vec102_1910, last_vec_1910.last_vec103 as last_vec103_1910, last_vec_1910.last_vec104 as last_vec104_1910, last_vec_1910.last_vec105 as last_vec105_1910, last_vec_1910.last_vec106 as last_vec106_1910, last_vec_1910.last_vec107 as last_vec107_1910, last_vec_1910.last_vec108 as last_vec108_1910, last_vec_1910.last_vec109 as last_vec109_1910, last_vec_1910.last_vec110 as last_vec110_1910, last_vec_1910.last_vec111 as last_vec111_1910, last_vec_1910.last_vec112 as last_vec112_1910, last_vec_1910.last_vec113 as last_vec113_1910, last_vec_1910.last_vec114 as last_vec114_1910, last_vec_1910.last_vec115 as last_vec115_1910, last_vec_1910.last_vec116 as last_vec116_1910, last_vec_1910.last_vec117 as last_vec117_1910, last_vec_1910.last_vec118 as last_vec118_1910, last_vec_1910.last_vec119 as last_vec119_1910, last_vec_1910.last_vec120 as last_vec120_1910, last_vec_1910.last_vec121 as last_vec121_1910, last_vec_1910.last_vec122 as last_vec122_1910, last_vec_1910.last_vec123 as last_vec123_1910, last_vec_1910.last_vec124 as last_vec124_1910, last_vec_1910.last_vec125 as last_vec125_1910, last_vec_1910.last_vec126 as last_vec126_1910, last_vec_1910.last_vec127 as last_vec127_1910, last_vec_1910.last_vec128 as last_vec128_1910, last_vec_1910.last_vec129 as last_vec129_1910, last_vec_1910.last_vec130 as last_vec130_1910, last_vec_1910.last_vec131 as last_vec131_1910, last_vec_1910.last_vec132 as last_vec132_1910, last_vec_1910.last_vec133 as last_vec133_1910, last_vec_1910.last_vec134 as last_vec134_1910, last_vec_1910.last_vec135 as last_vec135_1910, last_vec_1910.last_vec136 as last_vec136_1910, last_vec_1910.last_vec137 as last_vec137_1910, last_vec_1910.last_vec138 as last_vec138_1910, last_vec_1910.last_vec139 as last_vec139_1910, last_vec_1910.last_vec140 as last_vec140_1910, last_vec_1910.last_vec141 as last_vec141_1910, last_vec_1910.last_vec142 as last_vec142_1910, last_vec_1910.last_vec143 as last_vec143_1910, last_vec_1910.last_vec144 as last_vec144_1910, last_vec_1910.last_vec145 as last_vec145_1910, last_vec_1910.last_vec146 as last_vec146_1910, last_vec_1910.last_vec147 as last_vec147_1910, last_vec_1910.last_vec148 as last_vec148_1910, last_vec_1910.last_vec149 as last_vec149_1910, last_vec_1910.last_vec150 as last_vec150_1910, last_vec_1910.last_vec151 as last_vec151_1910, last_vec_1910.last_vec152 as last_vec152_1910, last_vec_1910.last_vec153 as last_vec153_1910, last_vec_1910.last_vec154 as last_vec154_1910, last_vec_1910.last_vec155 as last_vec155_1910, last_vec_1910.last_vec156 as last_vec156_1910, last_vec_1910.last_vec157 as last_vec157_1910, last_vec_1910.last_vec158 as last_vec158_1910, last_vec_1910.last_vec159 as last_vec159_1910, last_vec_1910.last_vec160 as last_vec160_1910, last_vec_1910.last_vec161 as last_vec161_1910, last_vec_1910.last_vec162 as last_vec162_1910, last_vec_1910.last_vec163 as last_vec163_1910, last_vec_1910.last_vec164 as last_vec164_1910, last_vec_1910.last_vec165 as last_vec165_1910, last_vec_1910.last_vec166 as last_vec166_1910, last_vec_1910.last_vec167 as last_vec167_1910, last_vec_1910.last_vec168 as last_vec168_1910, last_vec_1910.last_vec169 as last_vec169_1910, last_vec_1910.last_vec170 as last_vec170_1910, last_vec_1910.last_vec171 as last_vec171_1910, last_vec_1910.last_vec172 as last_vec172_1910, last_vec_1910.last_vec173 as last_vec173_1910, last_vec_1910.last_vec174 as last_vec174_1910, last_vec_1910.last_vec175 as last_vec175_1910, last_vec_1910.last_vec176 as last_vec176_1910, last_vec_1910.last_vec177 as last_vec177_1910, last_vec_1910.last_vec178 as last_vec178_1910, last_vec_1910.last_vec179 as last_vec179_1910, last_vec_1910.last_vec180 as last_vec180_1910, last_vec_1910.last_vec181 as last_vec181_1910, last_vec_1910.last_vec182 as last_vec182_1910, last_vec_1910.last_vec183 as last_vec183_1910, last_vec_1910.last_vec184 as last_vec184_1910, last_vec_1910.last_vec185 as last_vec185_1910, last_vec_1910.last_vec186 as last_vec186_1910, last_vec_1910.last_vec187 as last_vec187_1910, last_vec_1910.last_vec188 as last_vec188_1910, last_vec_1910.last_vec189 as last_vec189_1910, last_vec_1910.last_vec190 as last_vec190_1910, last_vec_1910.last_vec191 as last_vec191_1910, last_vec_1910.last_vec192 as last_vec192_1910, last_vec_1910.last_vec193 as last_vec193_1910, last_vec_1910.last_vec194 as last_vec194_1910, last_vec_1910.last_vec195 as last_vec195_1910, last_vec_1910.last_vec196 as last_vec196_1910, last_vec_1910.last_vec197 as last_vec197_1910, last_vec_1910.last_vec198 as last_vec198_1910, last_vec_1910.last_vec199 as last_vec199_1910, last_vec_1910.last_vec200 as last_vec200_1910, last_vec_1910.last_vec201 as last_vec201_1910

from Price.dbo.training_indices_1900_1910 as ind
left join Price.dbo.compact1900_census as census_1900 on ind.index_1900 = census_1900.index_1900
left join Price.dbo.compact1900_stringnames as stringnames_1900 on census_1900.index_1900 = stringnames_1900.index_1900
left join Price.dbo.crosswalk_nickname as nickname_1900 on stringnames_1900.first_1900 = nickname_1900.nickname
left join Price.dbo.compact1900_first_comm as first_comm_1900 on stringnames_1900.first_1900 = first_comm_1900.first_1900
left join Price.dbo.compact1900_last_comm as last_comm_1900 on stringnames_1900.last_1900 = last_comm_1900.last_1900
left join Price.dbo.compact1900_place as place_1900 on census_1900.index_1900 = place_1900.index_1900
left join Price.dbo.compact1910_bplace_comm as bplace_comm_1910 on census_1900.bp_1900 = bplace_comm_1910.int_place
left join Price.dbo.crosswalk_geo_bplace as geo_bplace_1900 on census_1900.bp_1900 = geo_bplace_1900.int_place
left join Price.dbo.crosswalk_geo_res as geo_res_1900 on place_1900.township = geo_res_1900.city and place_1900.county = geo_res_1900.county and place_1900.state = geo_res_1900.state
left join Price.dbo.crosswalk_first_vec as first_vec_1900 on stringnames_1900.first_1900 = first_vec_1900.pr_name_gn
left join Price.dbo.crosswalk_last_vec  as last_vec_1900  on stringnames_1900.last_1900  = last_vec_1900.pr_name_surn

left join Price.dbo.compact1910_census as census_1910 on ind.index_1910 = census_1910.index_1910
left join Price.dbo.compact1910_stringnames as stringnames_1910 on census_1910.index_1910 = stringnames_1910.index_1910
left join Price.dbo.crosswalk_nickname as nickname_1910 on stringnames_1910.first_1910 = nickname_1910.nickname
left join Price.dbo.compact1910_first_comm as first_comm_1910 on stringnames_1910.first_1910 = first_comm_1910.first_1910
left join Price.dbo.compact1910_last_comm as last_comm_1910 on stringnames_1910.last_1910 = last_comm_1910.last_1910
left join Price.dbo.compact1910_place as place_1910 on census_1910.index_1910 = place_1910.index_1910
left join Price.dbo.compact1910_bplace_comm as bplace_comm_1900 on census_1910.bp_1910 = bplace_comm_1900.int_place
left join Price.dbo.crosswalk_geo_bplace as geo_bplace_1910 on census_1910.bp_1910 = geo_bplace_1910.int_place
left join Price.dbo.crosswalk_geo_res as geo_res_1910 on place_1910.township = geo_res_1910.city and place_1910.county = geo_res_1910.county and place_1910.state = geo_res_1910.state
left join Price.dbo.crosswalk_first_vec as first_vec_1910 on stringnames_1910.first_1910 = first_vec_1910.pr_name_gn
left join Price.dbo.crosswalk_last_vec as last_vec_1910 on stringnames_1910.last_1910 = last_vec_1910.pr_name_surn
where ind.index_1900 >= {index1} and ind.index_1900 < {index2}"""
    #Create the object that finds all of the raw data from various files
    try:
        #Create the object that handles generating features
        feature_engineer = FeatureEngineer()
        features = ["imputer", "bool match", "euclidean distance", "jaro-winkler", 
                    "ngram", "drop", "commonality weight"] #FIXME add immigration imputer to FeatureEngineer
        first_vec = [f"first_vec{i}" for i in range(2, 202)]
        #last_vec = [f"last_vec{i}" for i in range(2,202)]
        cols_to_drop = ["marstat", "birth_year", "household", "immigration", "race", "rel", "female",
                        "bp", "mbp", "fbp", "state", "county", "cohort1", 
                        "cohort2", "last_sdxn", "first_sdxn", "last_init",
                        "first_init", "bp_comm", "first_comm", "last_comm", "bp_lat", "bp_lon",
                        "res_lat", "res_lon", "full_name"]
        cols_to_drop.extend(first_vec)
        #cols_to_drop.extend(last_vec)
        feature_params = [{"cols": ["first_comm", "last_comm"], "years": ["1900", "1910"]}, 
                          {"vars_to_match": ["marstat", "race", "rel", "mbp", "fbp", "first_sdxn", "last_sdxn", "bp", "county"], "years": ["1900", "1910"]},
                          {"variables": [["immigration"], ["birth_year"], ["res_lat", "res_lon"], ["bp_lat", "bp_lon"], [f"first_vec{i}" for i in range(2, 202)], [f"last_vec{i}" for i in range(2,202)]], "new_cols": ["immigration_dist", "birth_year_dist", "geodist", "bp_geodist", "first_vec_dist", "last_vec_dist"], "years": ["1900", "1910"]},
                          {"string_col": ["first", "last"], "dist_metric": "jw", "years": ["1900", "1910"]},
                          {"string_col": ["first", "last"], "n": 2, "years": ["1900", "1910"]},
                          {"cols_to_drop": ["first", "last"], "both_years": True, "years": ["1900", "1910"]},
                          {"cols": ["first_jw", "last_jw", "first_sdxn_match", "last_sdxn_match", "bp_match"], "comm_cols": ["first", "last", "first", "last", "bp"], "years": ["1900", "1910"]}]
    
        for i, j in zip(features, feature_params):
            feature_engineer.add_feature(i, j)
        
        #Create the object that trains the model
        trainer_predictor = XGBoostMatch()
        hyper_params = {"max_depth": [3], "learning_rate": [0.01], "n_estimators": [2500]}
        trainer_predictor.set_hyper_params(hyper_params)
        
        record_linker = Splycer(feature_engineer=feature_engineer, xgboost=trainer_predictor)
        conn = pyodbc.connect("DSN=rec_db")
        with open("R:/JoePriceResearch/record_linking/projects/deep_learning/ml-record-linking/model_post_sql3.xgboost", "rb") as file:
            model = pkl.load(file)
        percent_completed = 0
        print("Running predictions...")
        start = time()
        while index1 != 1000000:
            for chunk in pd.read_sql(sql_code, conn, chunksize = 100000):
                print(f"{percent_completed}% completed")
                percent_completed += 10
                record_linker.candidate_pairs = chunk
                #record_linker.candidate_pairs = record_linker.candidate_pairs.drop(["true_index_1920"], axis = 1)
                record_linker.candidate_pairs.loc[~record_linker.candidate_pairs.full_name_1900.isnull(), "first_1900"] = record_linker.candidate_pairs.loc[~record_linker.candidate_pairs.full_name_1900.isnull(), "full_name_1900"]
                record_linker.candidate_pairs.loc[~record_linker.candidate_pairs.full_name_1910.isnull(), "first_1910"] = record_linker.candidate_pairs.loc[~record_linker.candidate_pairs.full_name_1910.isnull(), "full_name_1910"]
                record_linker.create_features()
                record_linker.candidate_pairs = record_linker.candidate_pairs.drop([f"{i}_1900" for i in cols_to_drop], axis=1).drop([f"{i}_1910" for i in cols_to_drop], axis=1) #FIXME remove this for later batches
                record_linker.arks = record_linker.candidate_pairs.loc[:, ["index_1900", "index_1910"]]
                record_linker.candidate_pairs = record_linker.candidate_pairs.drop(["index_1900", "index_1910"], axis=1) #Add true_index_1920 back in if training and also generate true matches by comparing 1920 indices
                preds = pd.DataFrame(model.predict(record_linker.candidate_pairs), columns=["is_match"])
                preds = pd.concat([record_linker.arks, preds], axis=1)
                preds.to_csv("R:/JoePriceResearch/record_linking/data/preds/preds_1900_1910_pt1.csv", index=None, mode='a')
            index1 += 100000
            index2 += 100000
        end = time()
        print(f"time taken: {end - start} seconds")
        return end - start
    except Exception:
        print(traceback.format_exc())
        try:
            return record_linker
        except:
            return None
    
if __name__ == "__main__":
    time_taken = main()